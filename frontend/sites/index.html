---
page:
    body_class: 'sites-list fill-content'

bindings:
- name:     'sites'
  resource: '/api/sites'
  params:
    limit: false
    sort:  name

-  name:     baselines
   resource: '/api/restoration-stations'
   params: 
     limit:    false
     noexpand: true
     fields:   status,siteId,baselines
     q:        schoolOrg/not:571f6f3181ab586140097247

flags:
    viewSitesMap:  '{{ eqx (qs "v" "map") "map" }}'
    viewSitesList: '{{ eqx (qs "v" "map") "list" }}'

includes:
    sitesMap:  '/sites/sites_map.html'
    sitesList: '/sites/sites_list.html'
---
<h1>Research Sites</h1>

<ul class="nav nav-tabs mt-2 pl-1 pr-1">
    <li class="nav-item">
        <a class="nav-link{{ if $.flags.viewSitesMap }} active{{ end }}" href="/sites?v=map">
            <i class="fa fa-map-o"></i>
            Map
        </a>
    </li>

    <li class="nav-item">
        <a class="nav-link{{ if $.flags.viewSitesList }} active{{ end }}" href="/sites?v=list">
            <i class="fa fa-list"></i>
            List
        </a>
    </li>
</ul>

<section class="content sites-list-view">
    {{ if $.flags.viewSitesMap }}
    {{   template "sitesMap" . }}
    {{ else if $.flags.viewSitesList }}
    {{   template "sitesList" . }}
    {{ else }}
    <h2>Invalid view "{{ qs "v" }}"</h2>
    {{ end }}
</section>
